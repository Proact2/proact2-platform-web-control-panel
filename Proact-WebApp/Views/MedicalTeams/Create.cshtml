@model MedicalTeamCreateRequest

@{
    ViewData["Title"] = "Create new Medical Team";
    ViewBag.projects = TempData["projects"];
    ViewBag.medics = TempData["medics"];
}

<div class="row">
    <div class="col-md-8">

        <div class="card">
            <div class="card-header">
                <h3 class="card-title">Medical Team Data</h3>
            </div>

            <form asp-action="Create" id="MedicalTeamCreateForm" class="form-horizontal">
                <div class="card-body">

                    <div class="bs-stepper">
                        <div class="bs-stepper-header" role="tablist">
                            <!-- your steps here -->
                            <div class="step" data-target="#project-part">
                                <button type="button" class="step-trigger" role="tab" aria-controls="project-part" id="project-part-trigger">
                                    <span class="bs-stepper-circle">1</span>
                                    <span class="bs-stepper-label">Project</span>
                                </button>
                            </div>
                            <div class="line"></div>
                            <div class="step" data-target="#information-part">
                                <button type="button" class="step-trigger" role="tab" aria-controls="information-part" id="information-part-trigger">
                                    <span class="bs-stepper-circle">2</span>
                                    <span class="bs-stepper-label">Medical Team Info</span>
                                </button>
                            </div>
                            <div class="step" data-target="#timezone-part">
                                <button type="button" class="step-trigger" role="tab" aria-controls="information-part" id="information-part-trigger">
                                    <span class="bs-stepper-circle">3</span>
                                    <span class="bs-stepper-label">Timezone</span>
                                </button>
                            </div>
                            <div class="step" data-target="#administrator-part">
                                <button type="button" class="step-trigger" role="tab" aria-controls="administrator-part" id="administrator-part-trigger">
                                    <span class="bs-stepper-circle">4</span>
                                    <span class="bs-stepper-label">Medical Team Admin</span>
                                </button>
                            </div>

                        </div>
                        <div class="bs-stepper-content">
                            <!-- your steps content here -->
                            <div id="project-part" class="content" role="tabpanel" aria-labelledby="project-part-trigger">

                                <div class="form-group row">
                                    <label asp-for="ProjectId" class="col-sm-2 col-form-label"></label>
                                    <div class="col-sm-10">
                                        <select class="form-control select2bs4"
                                                style="width: 100%;"
                                                asp-for="ProjectId">
                                            @foreach ( ProjectModel item in ViewBag.projects )
                                            {
                                                @if (ViewBag.projectId != null && ViewBag.projectId == item.ProjectId.ToString())
                                                {
                                                    <option selected value="@item.ProjectId"> @Html.DisplayFor(modelItem => item.Name)</option>
                                                }
                                                else
                                                {
                                                    <option value="@item.ProjectId"> @Html.DisplayFor(modelItem => item.Name)</option>
                                                }
                                            }
                                        </select>
                                        <span asp-validation-for="ProjectId" class="text-danger"></span>
                                    </div>
                                </div>


                                <a class="btn btn-primary float-right step-next">Next</a>
                            </div>

                            <div id="information-part" class="content" role="tabpanel" aria-labelledby="information-part-trigger">

                                <div class="form-group row">
                                    <label asp-for="Name" class="col-sm-2 col-form-label"></label>
                                    <div class="col-sm-10">
                                        <input name="name" asp-for="Name" class="form-control">
                                        <span asp-validation-for="Name" class="text-danger"></span>
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label asp-for="AddressLine1" class="col-sm-2 col-form-label"></label>
                                    <div class="col-sm-10">
                                        <input name="addressLine1" asp-for="AddressLine1" class="form-control">
                                        <span asp-validation-for="AddressLine1" class="text-danger"></span>
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label asp-for="AddressLine2" class="col-sm-2 col-form-label"></label>
                                    <div class="col-sm-10">
                                        <input asp-for="AddressLine2" class="form-control">
                                        <span asp-validation-for="AddressLine2" class="text-danger"></span>
                                    </div>
                                </div>

                                <div class="form-group row">
                                    <label asp-for="City" class="col-sm-2 col-form-label"></label>
                                    <div class="col-sm-10">
                                        <input name="city" asp-for="City" class="form-control">
                                        <span asp-validation-for="City" class="text-danger"></span>
                                    </div>
                                </div>

                                <div class="form-group row">
                                    <label asp-for="StateOrProvince" class="col-sm-2 col-form-label"></label>
                                    <div class="col-sm-10">
                                        <input asp-for="StateOrProvince" class="form-control">
                                        <span asp-validation-for="StateOrProvince" class="text-danger"></span>
                                    </div>
                                </div>

                                <div class="form-group row">
                                    <label asp-for="RegionCode" class="col-sm-2 col-form-label"></label>
                                    <div class="col-sm-10">
                                        <input name="regionCode" asp-for="RegionCode" class="form-control">
                                        <span asp-validation-for="RegionCode" class="text-danger"></span>
                                    </div>
                                </div>

                                <div class="form-group row">
                                    <label asp-for="PostalCode" class="col-sm-2 col-form-label"></label>
                                    <div class="col-sm-10">
                                        <input name="postalCode" asp-for="PostalCode" class="form-control">
                                        <span asp-validation-for="PostalCode" class="text-danger"></span>
                                    </div>
                                </div>

                                <div class="form-group row">
                                    <label asp-for="Country" class="col-sm-2 col-form-label"></label>
                                    <div class="col-sm-10">
                                        <input name="country" asp-for="Country" class="form-control">
                                        <span asp-validation-for="Country" class="text-danger"></span>
                                    </div>
                                </div>

                                <div class="form-group row">
                                    <label asp-for="Phone" class="col-sm-2 col-form-label"></label>
                                    <div class="col-sm-10">
                                        <input asp-for="Phone" class="form-control">
                                        <span asp-validation-for="Phone" class="text-danger"></span>
                                    </div>
                                </div>

                                <a class="btn btn-primary float-left step-prev">Previous</a>
                                <a class="btn btn-primary float-right step-next">Next</a>
                            </div>

                            <div id="timezone-part" class="content" role="tabpanel" aria-labelledby="project-part-trigger">

                                <div class="form-group row">
                                    <label asp-for="TimeZone" class="col-sm-2 col-form-label"></label>
                                    <div class="col-sm-10">
                                        <select class="form-control select2bs4"
                                                id="timezone"
                                                style="width: 100%;"
                                                asp-for="TimeZone">
                                        </select>
                                        <span asp-validation-for="TimeZone" class="text-danger"></span>
                                    </div>
                                </div>

                                <a class="btn btn-primary float-left step-prev">Previous</a>
                                <a class="btn btn-primary float-right step-next">Next</a>
                            </div>

                            <div id="administrator-part" class="content" role="tabpanel" aria-labelledby="administrator-part-trigger">
                                <div class="form-group row">
                                    <label asp-for="UserId" class="col-sm-2 col-form-label"></label>
                                    <div class="col-sm-10">
                                        <select class="form-control select2bs4"
                                                style="width: 100%;"
                                                asp-for="UserId">
                                            @foreach (MedicModel item in ViewBag.medics )
                                            {
                                                <option value="@item.UserId">@Html.DisplayFor(modelItem => item.Name)</option>
                                            }
                                        </select>
                                        <span asp-validation-for="UserId" class="text-danger"></span>
                                    </div>
                                </div>

                                <a class="btn btn-primary float-left step-prev">Previous</a>
                                <button type="submit" class="btn float-right btn-success">Create</button>
                            </div>
                        </div>
                    </div>

                </div>

                <div class="card-footer">
                    <a asp-action="Index" asp-route-projectId="@ViewBag.projectId" class="btn btn-default">Back</a>
                </div>

            </form>

        </div>
    </div>


</div>

@section Scripts {

    <!-- BS-Stepper -->
    <script src="~/lib/bs-stepper/js/bs-stepper.min.js"></script>
    <!-- Select2 -->
    <script src="~/lib/select2/js/select2.full.min.js"></script>
    <!-- jquery-validation -->
    <script src="~/lib/jquery-validation/jquery.validate.min.js"></script>
    <script src="~/lib/jquery-validation/additional-methods.min.js"></script>
    <!-- Timezones-->
    <script src="~/lib/timezones/timezones.full.js"></script>

    <script>$(function () {

            var stepper = new Stepper($('.bs-stepper')[0])
            var currentStep = 0;

            $('.step-next').click(function (e) {
                if (currentStep == 1) {
                    if ($("#MedicalTeamCreateForm").valid()) {
                        stepper.next();
                        currentStep++;
                    }
                }
                else {
                    stepper.next();
                    currentStep++;
                }
            });

            $('.step-prev').click(function (e) {
                stepper.previous();
                currentStep--;
            });

            $('.select2').select2();

            $('.select2bs4').select2({
                theme: 'bootstrap4'
            });

            $('#timezone').timezones();


            $('#MedicalTeamCreateForm').validate({
                rules: {
                    name: {
                        required: true
                    },
                    addressLine1: {
                        required: true
                    },
                    city: {
                        required: true
                    },
                    regionCode: {
                        pattern: "^([A-Z]{2}-[A-Z0-9]{1,3})$"
                    },
                    postalCode: {
                        required: true
                    },
                    country: {
                        required: true
                    },

                },
                messages: {
                    name: {
                        required: "Required"
                    },
                    addressLine1: {
                        required: "Required"
                    },
                    city: {
                        required: "Required"
                    },
                    regionCode: {
                        pattern: "Invalid Region Code"
                    },
                    postalCode: {
                        required: "Required"
                    },
                    country: {
                        required: "Required"
                    },
                },
                errorElement: 'span',
                errorPlacement: function (error, element) {
                    error.addClass('invalid-feedback');
                    element.closest('.form-group').append(error);
                },
                highlight: function (element, errorClass, validClass) {
                    $(element).addClass('is-invalid');
                },
                unhighlight: function (element, errorClass, validClass) {
                    $(element).removeClass('is-invalid');
                }
            });



        });</script>
}